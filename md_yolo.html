<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>YOLO Image Recognition | Intelligent Quads Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+doxygen.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">Intelligent Quads Documentation</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          YOLO Image Recognition
        </h1>
<h3>Detection Using A Pre-Trained Model</h3><p>This post will guide you through detecting objects with the YOLO system using a pre-trained model. If you don&#x27;t already have Darknet installed, you should do that first.</p><pre class="m-code"><span class="n">git</span> <span class="n">clone</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//github.com/pjreddie/darknet</span>
<span class="n">cd</span> <span class="n">darknet</span>
<span class="n">make</span></pre><p>Easy!</p><p>You already have the config file for YOLO in the cfg/ subdirectory. You will have to download the pre-trained weight file <code class="m-code"><span class="n">wget</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//pjreddie.com/media/files/yolov3.weights</span></code> Then run the detector!</p><p><code class="m-code"><span class="p">.</span><span class="o">/</span><span class="n">darknet</span> <span class="n">detect</span> <span class="n">cfg</span><span class="o">/</span><span class="n">yolov3</span><span class="p">.</span><span class="n">cfg</span> <span class="n">yolov3</span><span class="p">.</span><span class="n">weights</span> <span class="n">data</span><span class="o">/</span><span class="n">dog</span><span class="p">.</span><span class="n">jpg</span></code> You will see some output like this:</p><pre class="m-code"><span class="n">layer</span>     <span class="n">filters</span>    <span class="n">size</span>              <span class="n">input</span>                <span class="n">output</span>
    <span class="mi">0</span> <span class="n">conv</span>     <span class="mi">32</span>  <span class="mi">3</span> <span class="n">x</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">1</span>   <span class="mi">416</span> <span class="n">x</span> <span class="mi">416</span> <span class="n">x</span>   <span class="mi">3</span>   <span class="o">-&gt;</span>   <span class="mi">416</span> <span class="n">x</span> <span class="mi">416</span> <span class="n">x</span>  <span class="mi">32</span>  <span class="mf">0.299</span> <span class="n">BFLOPs</span>
    <span class="mi">1</span> <span class="n">conv</span>     <span class="mi">64</span>  <span class="mi">3</span> <span class="n">x</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span>   <span class="mi">416</span> <span class="n">x</span> <span class="mi">416</span> <span class="n">x</span>  <span class="mi">32</span>   <span class="o">-&gt;</span>   <span class="mi">208</span> <span class="n">x</span> <span class="mi">208</span> <span class="n">x</span>  <span class="mi">64</span>  <span class="mf">1.595</span> <span class="n">BFLOPs</span>
    <span class="p">.......</span>
  <span class="mi">105</span> <span class="n">conv</span>    <span class="mi">255</span>  <span class="mi">1</span> <span class="n">x</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1</span>    <span class="mi">52</span> <span class="n">x</span>  <span class="mi">52</span> <span class="n">x</span> <span class="mi">256</span>   <span class="o">-&gt;</span>    <span class="mi">52</span> <span class="n">x</span>  <span class="mi">52</span> <span class="n">x</span> <span class="mi">255</span>  <span class="mf">0.353</span> <span class="n">BFLOPs</span>
  <span class="mi">106</span> <span class="n">detection</span>
<span class="nl">truth_thresh</span><span class="p">:</span> <span class="n">Using</span> <span class="k">default</span> <span class="err">&#39;</span><span class="mf">1.000000</span><span class="err">&#39;</span>
<span class="n">Loading</span> <span class="n">weights</span> <span class="n">from</span> <span class="n">yolov3</span><span class="p">.</span><span class="n">weights</span><span class="p">...</span><span class="n">Done</span><span class="o">!</span>
<span class="n">data</span><span class="o">/</span><span class="n">dog</span><span class="p">.</span><span class="nl">jpg</span><span class="p">:</span> <span class="n">Predicted</span> <span class="n">in</span> <span class="mf">0.029329</span> <span class="n">seconds</span><span class="p">.</span>
<span class="nl">dog</span><span class="p">:</span> <span class="mi">99</span><span class="o">%</span>
<span class="nl">truck</span><span class="p">:</span> <span class="mi">93</span><span class="o">%</span>
<span class="nl">bicycle</span><span class="p">:</span> <span class="mi">99</span><span class="o">%</span></pre><p>Darknet prints out the objects it detected, its confidence, and how long it took to find them. We didn&#x27;t compile Darknet with OpenCV so it can&#x27;t display the detections directly. Instead, it saves them in predictions.png. You can open it to see the detected objects. Since we are using Darknet on the CPU it takes around 6-12 seconds per image. If we use the GPU version it would be much faster.</p><h3>Multiple Images</h3><p>Instead of supplying an image on the command line, you can leave it blank to try multiple images in a row. Instead you will see a prompt when the config and weights are done loading:</p><pre class="m-code"><span class="p">.</span><span class="o">/</span><span class="n">darknet</span> <span class="n">detect</span> <span class="n">cfg</span><span class="o">/</span><span class="n">yolov3</span><span class="p">.</span><span class="n">cfg</span> <span class="n">yolov3</span><span class="p">.</span><span class="n">weights</span>
<span class="n">layer</span>     <span class="n">filters</span>    <span class="n">size</span>              <span class="n">input</span>                <span class="n">output</span>
    <span class="mi">0</span> <span class="n">conv</span>     <span class="mi">32</span>  <span class="mi">3</span> <span class="n">x</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">1</span>   <span class="mi">416</span> <span class="n">x</span> <span class="mi">416</span> <span class="n">x</span>   <span class="mi">3</span>   <span class="o">-&gt;</span>   <span class="mi">416</span> <span class="n">x</span> <span class="mi">416</span> <span class="n">x</span>  <span class="mi">32</span>  <span class="mf">0.299</span> <span class="n">BFLOPs</span>
    <span class="mi">1</span> <span class="n">conv</span>     <span class="mi">64</span>  <span class="mi">3</span> <span class="n">x</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span>   <span class="mi">416</span> <span class="n">x</span> <span class="mi">416</span> <span class="n">x</span>  <span class="mi">32</span>   <span class="o">-&gt;</span>   <span class="mi">208</span> <span class="n">x</span> <span class="mi">208</span> <span class="n">x</span>  <span class="mi">64</span>  <span class="mf">1.595</span> <span class="n">BFLOPs</span>
    <span class="p">.......</span>
  <span class="mi">104</span> <span class="n">conv</span>    <span class="mi">256</span>  <span class="mi">3</span> <span class="n">x</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">1</span>    <span class="mi">52</span> <span class="n">x</span>  <span class="mi">52</span> <span class="n">x</span> <span class="mi">128</span>   <span class="o">-&gt;</span>    <span class="mi">52</span> <span class="n">x</span>  <span class="mi">52</span> <span class="n">x</span> <span class="mi">256</span>  <span class="mf">1.595</span> <span class="n">BFLOPs</span>
  <span class="mi">105</span> <span class="n">conv</span>    <span class="mi">255</span>  <span class="mi">1</span> <span class="n">x</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1</span>    <span class="mi">52</span> <span class="n">x</span>  <span class="mi">52</span> <span class="n">x</span> <span class="mi">256</span>   <span class="o">-&gt;</span>    <span class="mi">52</span> <span class="n">x</span>  <span class="mi">52</span> <span class="n">x</span> <span class="mi">255</span>  <span class="mf">0.353</span> <span class="n">BFLOPs</span>
  <span class="mi">106</span> <span class="n">detection</span>
<span class="n">Loading</span> <span class="n">weights</span> <span class="n">from</span> <span class="n">yolov3</span><span class="p">.</span><span class="n">weights</span><span class="p">...</span><span class="n">Done</span><span class="o">!</span>
<span class="n">Enter</span> <span class="n">Image</span> <span class="nl">Path</span><span class="p">:</span></pre><p>Enter an image path like data/horses.jpg to have it predict boxes for that image.</p><p>Once it is done it will prompt you for more paths to try different images. Use Ctrl-C to exit the program once you are done.</p><h3>Changing The Detection Threshold</h3><p>By default, YOLO only displays objects detected with a confidence of .25 or higher. You can change this by passing the -thresh &lt;val&gt; flag to the yolo command. For example, to display all detection you can set the threshold to 0:</p><p><code class="m-code"><span class="p">.</span><span class="o">/</span><span class="n">darknet</span> <span class="n">detect</span> <span class="n">cfg</span><span class="o">/</span><span class="n">yolov3</span><span class="p">.</span><span class="n">cfg</span> <span class="n">yolov3</span><span class="p">.</span><span class="n">weights</span> <span class="n">data</span><span class="o">/</span><span class="n">dog</span><span class="p">.</span><span class="n">jpg</span> <span class="o">-</span><span class="n">thresh</span> <span class="mi">0</span></code> Which produces:</p><p>![][all]</p><p>So that&#x27;s obviously not super useful but you can set it to different values to control what gets thresholded by the model</p><h3>Tiny YOLOv3</h3><p>We have a very small model as well for constrained environments, <code>yolov3-tiny</code>. To use this model, first download the weights:</p><p><code class="m-code"><span class="n">wget</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//pjreddie.com/media/files/yolov3-tiny.weights</span></code> Then run the detector with the tiny config file and weights:</p><p><code class="m-code"><span class="p">.</span><span class="o">/</span><span class="n">darknet</span> <span class="n">detect</span> <span class="n">cfg</span><span class="o">/</span><span class="n">yolov3</span><span class="o">-</span><span class="n">tiny</span><span class="p">.</span><span class="n">cfg</span> <span class="n">yolov3</span><span class="o">-</span><span class="n">tiny</span><span class="p">.</span><span class="n">weights</span> <span class="n">data</span><span class="o">/</span><span class="n">dog</span><span class="p">.</span><span class="n">jpg</span></code></p><h3>Compiling With CUDA and Opencv</h3><p>Darknet on the CPU is fast but it&#x27;s like 500 times faster on GPU! You&#x27;ll have to have an Nvidia GPU and you&#x27;ll have to install CUDA and opencv. If you have installed ROS desktop you should already have opencv installed</p><h3>Install CUDA</h3><p><a href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html">https:/<wbr />/<wbr />docs.nvidia.com/<wbr />cuda/<wbr />cuda-installation-guide-linux/<wbr />index.html</a></p><p>Once you have CUDA installed, change the first couple lines of the Makefile in the base directory to read:</p><pre class="m-code"><span class="n">GPU</span><span class="o">=</span><span class="mi">1</span>
<span class="n">OPENCV</span><span class="o">=</span><span class="mi">1</span></pre><p>Now you can make the project and CUDA will be enabled. By default it will run the network on the 0th graphics card in your system (if you installed CUDA correctly you can list your graphics cards using <code>nvidia-smi</code>). Again you can run</p><p><code class="m-code"><span class="p">.</span><span class="o">/</span><span class="n">darknet</span> <span class="n">detect</span> <span class="n">cfg</span><span class="o">/</span><span class="n">yolov3</span><span class="p">.</span><span class="n">cfg</span> <span class="n">yolov3</span><span class="p">.</span><span class="n">weights</span> <span class="n">data</span><span class="o">/</span><span class="n">dog</span><span class="p">.</span><span class="n">jpg</span></code></p><h3>Note</h3><p>Yolo v3 uses a lot of gpu ram. if you get the following error consider using tiny-yolo or yolov2</p><p>grab pretrained weights for yolo V2 using <code class="m-code"><span class="n">wget</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//pjreddie.com/media/files/yolov3.weights</span></code></p><p>run YOLOv2</p><p><code class="m-code"><span class="p">.</span><span class="o">/</span><span class="n">darknet</span> <span class="n">detect</span> <span class="n">cfg</span><span class="o">/</span><span class="n">yolov2</span><span class="p">.</span><span class="n">cfg</span> <span class="n">yolov2</span><span class="p">.</span><span class="n">weights</span> <span class="n">data</span><span class="o">/</span><span class="n">dog</span><span class="p">.</span><span class="n">jpg</span></code></p><h3>Real-Time Detection on a Webcam</h3><p>Running YOLO on test data isn&#x27;t very interesting if you can&#x27;t see the result. Instead of running it on a bunch of images let&#x27;s run it on the input from a webcam!</p><p>To run this demo you will need to compile Darknet with CUDA and OpenCV.</p><p>To run this demo you will need to compile Darknet with CUDA and OpenCV. Then run the command: <code class="m-code"><span class="p">.</span><span class="o">/</span><span class="n">darknet</span> <span class="n">detector</span> <span class="n">demo</span> <span class="n">cfg</span><span class="o">/</span><span class="n">coco</span><span class="p">.</span><span class="n">data</span> <span class="n">cfg</span><span class="o">/</span><span class="n">yolov3</span><span class="p">.</span><span class="n">cfg</span> <span class="n">yolov3</span><span class="p">.</span><span class="n">weights</span></code> YOLO will display the current FPS and predicted classes as well as the image with bounding boxes drawn on top of it.</p><p>You will need a webcam connected to the computer that OpenCV can connect to or it won&#x27;t work. If you have multiple webcams connected and want to select which one to use you can pass the flag -c &lt;num&gt; to pick (OpenCV uses webcam 0 by default).</p><p>You can also run it on a video file if OpenCV can read the video: <code class="m-code"><span class="p">.</span><span class="o">/</span><span class="n">darknet</span> <span class="n">detector</span> <span class="n">demo</span> <span class="n">cfg</span><span class="o">/</span><span class="n">coco</span><span class="p">.</span><span class="n">data</span> <span class="n">cfg</span><span class="o">/</span><span class="n">yolov3</span><span class="p">.</span><span class="n">cfg</span> <span class="n">yolov3</span><span class="p">.</span><span class="n">weights</span> <span class="o">&lt;</span><span class="n">video</span> <span class="n">file</span><span class="o">&gt;</span></code></p><h3>Use YOLO to train your own custom classes</h3><p><a href="md_yoloTraining.html" class="m-dox">Training YOLO with BBox-Label-Tool</a></p><h3>Cite</h3><p>If you use YOLOv3 in your work please cite our paper!</p><p>@article{yolov3, title={YOLOv3: An Incremental Improvement}, author={Redmon, Joseph and Farhadi, Ali}, journal = {arXiv}, year={2018} }</p>
      </div>
    </div>
  </div>
</article></main>
<div class="m-dox-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-dox-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-dox-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>

          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search.js"></script>
<script src="searchdata.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Intelligent Quads Documentation. Created by <a href="https://doxygen.org/">Doxygen</a> 1.8.16 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
